Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1};Array.prototype.remove=function(e){var t=this.indexOf(e);if(t>=0)return this.splice(t,1);else return this};String.prototype.capitalize=function(){if(this.length==0)return"";return this.charAt(0).toUpperCase()+this.splice(1)};String.prototype.title=function(){return this.split(" ").map(function(e){return r.capitalize()}).join(" ")};String.prototype.trim=function(){return this.replace(/^\s+|\s+$/gm,"")};String.prototype.ltrim=function(){return this.replace(/^\s+/gm,"")};String.prototype.rtrim=function(){return this.replace(/\s+$/gm,"")};String.prototype.format=function(e){return this.replace(/{(\d+)}/g,function(t,n){return!(typeof e[n]==="undefined")?e[n]:t})};String.prototype.escapeRegExp=function(){return this.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")};String.prototype.escapeHTML=function(){var e={'"':"&quot;","&":"&","<":"&lt;",">":"&gt;"};return this.replace(/[\"&<>]/g,function(t){return e[t]})};String.prototype.startsWith=function(e){return this.substring(0,e.length)==e};String.prototype.endsWith=function(e){return this.substring(this.length-e.length)==e};String.prototype.times=function(e){var t;for(k=0;k<e;k++)t=t+this;return t};if(!Object.prototype.watch){Object.defineProperty(Object.prototype,"watch",{enumerable:false,configurable:true,writable:false,value:function(e,t){var n=this[e],r=n;var i=function(){return r};var s=function(i){n=r;return r=t.call(this,e,n,i)};if(delete this[e]){Object.defineProperty(this,e,{get:i,set:s,enumerable:true,configurable:true})}}})}if(!Object.prototype.unwatch){Object.defineProperty(Object.prototype,"unwatch",{enumerable:false,configurable:true,writable:false,value:function(e){var t=this[e];delete this[e];this[e]=t}})}my=function(){var e={};e.isUndefined=function(e){return typeof e==="undefined"};e.isFunction=function(e){return e&&{}.toString.call(e)==="[object Function]"};e.range=function(t,n,r){if(e.isUndefined(n)){n=t;t=0}var i=[];for(var s=t;s<n;s+=r||1)i.push(s);return i};e.sum=function(e,t){var n=0;for(var r=0;r<e.length;r++)n+=e[r];return n};e.keys=function(e,t){var n=[];for(var r in e)n.push(r);if(t)n.sort();return n};e.values=function(e){return keys(e).map(function(t){return e[t]})};e.items=function(e){return keys(e).map(function(t){return[t,e[t]]})};e.len=function(e){if(e instanceof Array)return e.length;else return keys(e).length};e.clone=function(e){return JSON.parse(JSON.stringify(e))};e.debounce=function(e,t){t||(t=250);var n=null;return function(){var r=this,i=arguments;clearTimeout(n);n=setTimeout(function(){e.apply(r,i)},t)}};e.throttle=function(e,t,n){t||(t=250);var r,i;return function(){var s=n||this;var o=+(new Date),u=arguments;if(r&&o<r+t){clearTimeout(i);i=setTimeout(function(){r=o;e.apply(s,u)},t)}else{r=o;e.apply(s,u)}}};e.tag=function(e,t){e=e||"div";t=t||{};var n=function(){var n=arguments.callee;var r=[];for(var i in arguments)r[i]=arguments[i];if(!n.Tag)n.Tag=function(e,t,n){this.name=e;this.components=t;this.attrtibutes=n;this.toString=function(){if(e==null)return t.join("");var r="";for(var i in n){var s=(""+n[i]).escapeHTML();r='{0} {1}="{2}"'.format([r,i,s])}if("img br link".split(" ").indexOf(e)<0){var s=t.map(function(e){if(typeof e=="string")return e.escapeHTML();return e.toString()}).join("");return"<{0}{1}>{2}</{0}>".format([e,r,s])}else{return"<{0}{1}/>".format([e,r])}}};return new arguments.callee.Tag(e,r,t)};return n};e.events={};e.register=function(t,n,r){if(t in e.events)e.events[t].push([n,r]);else e.events[t]=[[n,r]]};e.trigger=function(t,n){if(t in e.events)e.events[t]=e.events[t].filter(function(e){e[0](n);if(!e[1])return e})};e.promise_counter=0;var t=function(){this.code=e.promise_counter++;this.resolved=false;this.rejected=false;this.obj=null;this.resolve=function(t){this.resolved=true;this.obj=t;e.trigger(this.code+":resolved",t)};this.reject=function(t){this.rejected=true;this.obj=t;e.trigger(this.code+":rejected",t)};this.then=function(t,n){t=t||function(e){return e};if(n=="always")n=t;n=n||function(e){throw e};if(this.resolved){return e.run(t,this.obj)}else if(this.rejected){return e.run(n,this.obj)}else{var r=e.promise();e.register(this.code+":resolved",function(e){try{r.resolve(t(e))}catch(n){r.reject(n)}});e.register(this.code+":rejected",function(e){try{r.resolve(n(e))}catch(t){r.reject(t)}});return r}}};e.run=function(t,n){var r=e.promise();try{var i=t(n);if(e.isFunction(i.then))return i;r.resolve(i)}catch(s){r.reject(s)}return r};e.promise=function(){return new t};e.sleep=function(t){var n=e.promise();setTimeout(function(){n.resolve()},t);return n};e.model_counter=0;e.model=function(t){var n=e.model_counter++;var r="model-change:{0}".format([n]);delete e.events[r];for(var i in t){if(!e.isFunction(t[i])){t.watch(i,function(t,n,i){if(i!=n){e.trigger(r,[t,n,i])}return i})}}t.onChangeCall=function(t){e.register(r,function(e){t.apply(null,e)})};t.linkToTemplate=function(n){var r=jQuery(n);var i=r.html();var s=function(){var n=Mustache.render(i,t);r.html(n);r.find("[my-bind]").each(function(){var n=jQuery(this);var r=n.attr("id");var i=function(){var e=n.attr("my-bind");t[e]=n.val();s();input=jQuery("[my-bind={0}]".format([e]));input.focus().val("").val(t[e])};n.on("keyup change",e.throttle(i,1e3))})};s()};return t};return e}()